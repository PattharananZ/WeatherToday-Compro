 # Project Introduction กล่องพยากรณ์อากาศสุดอัจฉริยะ!!
สวัสดีครับ พวกเรากลุ่ม `4 Yod Kuman` ขอเสนอโปรเจค "Weather Today" โดยเป็นโปรเจค Microcontroller Arduino เกี่ยวกับ การพยากรณ์อุณหภูมิ สภาพฝนฟ้าอากาศในแต่ละวัน โดยมีการแจ้งเตือนผ่านระบบLine หลักการทำงาน มาจากระบบSensor ตรวจจับอุณหภูมิ ความชื้น และปริมาณน้ำฝน ในขณะนั้นซึ่งตัว
ผลิตภัณฑ์ในโปรเจคของเรานั้นมีชื่อว่า "Intelligent Weather Box" สิ่งนี้เป็นสิ่งที่เป็นประโยชน์ต่อผู้ใช้งานเป็นอย่างมาก ทำให้ผู้ใช้งานสามารถรู้อุณหภูมิ ความชื้น 
ในทุกๆเวลาตามที่เรากำหนดจะให้แจ้งเตือนแล้ว ยังสามรถรู้ได้ว่าฝนกำลังจะตกหรือไม่ และแจ้งเตือนผู้ใช้งานเมื่อฝนตกผ่านระบบLine ซึ่งสะดวกต่อผู้ใช้งานในปัจจุบัน
![](https://66.media.tumblr.com/d0ff910289719eeedc58f78b988bd0d0/tumblr_pqu19tZ9eR1yo55ppo1_1280.jpg)
***
# Features ฟังก์ชั่นที่ตอบสนองต่อผู้ใช้งาน
สำหรับการใช้งานเครื่อง Intelligent Weather Box ก็จะมีฟังก์ชั่นย่อยต่างๆ ในการแจ้งเตือนเกี่ยวกับสภาพอากาศ เช่น
* ฟังก์ชั่นการบอกค่าอุณหภูมิ
* ฟังก์ชั่นการบอกค่าความชื้นในอากาศ
* ฟังก์ชั่นการแจ้งเตือนสภาพอากาศ ณ ขณะนั้น
* ฟังก์ชั่นการแจ้งเตือนเมื่อฝนตก
* ฟังก์ชั่นกราฟสรุปอุณหภูมิและความชื้น

โดยทุกระบบที่กล่าวมานั้น เราสามารถปรับเปลี่ยนเวลาการแจ้งเตือน และข้อความการเตือนได้ด้วยตนเอง
***
# Equipment อุปกรณ์ที่ใช้การจัดทำ
| Accessory name | Description                    |
| ------------- | ------------------------------ |
| `NodeMCU ESP82660`| โมดูล wifi ภายในมีเฟิร์มแวร์ทํางานในลักษณะ Serial-to-WiFi ที่ช่วยให้อุปกรณ์อื่นๆ เช่น MCU สามารถต่อเข้ากับ internet ได้โดยใช้ port serialและใช้คําสั่ง AT ในการควบคุมการทํางาน ต่อมาผู้พัฒนาได้พัฒนาเฟิร์มแวร์ NodeMcu ให้เป็น platform และใช้ภาษา LUA ในการเขียนโปรแกรม ด้วยความที่เป็น platform ที่สะดวกต่อการใช้งาน ทางผู้พัฒนาจึงจับ NodeMcu(ESP8266) ใส่เป็นบอร์ดหนึ่งใน Arduino IDE|
| `DHT22`   | เป็นเซ็นเซอร์สำหรับวัดอุณหภูมิและความชื้นที่มีความแม่นยำสูงในการวัด สามารถวัดได้ในย่านอุณหภูมิ ตั้งแต่ -40 องศาเซลเซียส ถึง +80 องศาเซลเซียส ความแม่นยำน้อยกว่า +-0.5เซลเซียส และวัดความชื้นสัมพัทธ์ได้ในย่าน 0-100%RH ความแม่นยำ +-2-5%RH|
| `Water Flow Sensor`   | Sensor ที่ทำหน้าที่ในการวัดอัตราการไหลของของเหลว ที่ไหลผ่านตัวSensorหรือนำค่าที่วัดได้มาคำนวณเป็นปริมาณน้ำก็ได้ครับ โดยปกติแล้วค่าที่วัดได้จะออกมาเป็นสัญญาณ Pulse|
| `LED RGB`   | หลอด LED RGB ภายในหลอดจะมี LED ทั้งหมด 3 แม่สี คือ สีแดง สีเขียว และสีน้ำเงิน อยู่ภายใน และมีขาต่อใช้งานทั้งหมด 4 ขา ประกอบด้วยขา Common R G และ B ซึ่งขา Common|
| `Breadboard MB-102`   | บอร์ดที่ใช้เสียบสายไฟ เซ็นเซอร์ หลอดไฟ ตัวต้านทานในการทดลองนั่นเอง|
| `Jumper Wires Male-Male`   | สายไฟจัมเปอร์ ที่ใช้เชื่อมต่อส่งกระแสไฟต่างๆ ชนิดหัวผู้-ผู้  20 CM |
| `Resistor`   | คือ ตัวต้านทานที่ต่ออยู่ในวงจรไฟฟ้าทำหน้าที่ในการต้านการไหลของกระแสไฟฟ้าไหลผ่าน ทำด้วยลวดต้านทานหรือถ่านคาร์บอน เป็นต้น ในกรณีที่ มีความต้านทานมากจะยอมให้กระแสไฟฟ้าไหลผ่านได้น้อยลง หากกลับกัน หากมีความต้านทานน้อยจะยอมให้กระแสไฟฟ้าไหลผ่านได้มาก|
| `USB Cable`   | ใช้เป็นหลักในการเชื่อมต่ออุปกรณ์ USB เข้ากับNodeMCU ESP8266|
***
# Installation ขั้นตอนการติดตั้งสำหรับผู้ใช้งาน
`กรณีที่ผู้ใช้งานต้องการจะติดตั้งตั้งค่าต่างๆเอง`
สำหรับการใช้งานนั้น ผู้ใช้จะต้องทำการโหลดโปรแกรม Arduino และ Library ต่างๆมาติดตั้งบนคอมพิวเตอร์ของคุณ 
* วิธีติดตั้งโปรแกรม[Click!!](https://www.youtube.com/watch?v=dMujuIKpWdM)
* วิธีติดตั้งไลบรารี่ต่างๆ[Click!!](https://www.youtube.com/watch?v=tO4FLMQ0MHY)
### เมื่อทำการติดตั้งProgram เสร็จให้ทำการโหลดไฟล์ Project arduino และLibrary ต่างๆ ด้านล่างนี้
* Arduino File ไฟล์ที่ใช้ในการรันโปรแรม [Click!!](https://drive.google.com/file/d/1-7p4GFSoRbYO7HelgWzeTUQVKmlyy83L/view?usp=sharing)
* Library ที่ใช้ในโปรเจค กลุ่มเราได้ทำการรวมไว้ให้แล้วเรียบร้อย สามารถDowloadได้ [Click!!](https://drive.google.com/file/d/1Ra2NMGnvzmOFBeh0aJQixoQ4B3FlYeci/view?usp=sharing)
`ปล.แตกไฟล์ libraries.rar แล้วนำไปแทนโฟลเดอร์ libraries ที่อยู่ในDocument/arduino ได้เลยครับ`
***
# Setting การตั้งค่าเพื่อเริ่มต้นการใช้งาน
เริ่มต้นให้ผู้ใช้ทำการเปิดไฟล์`Weatherbox.ino`ในโปรแกรม Arduino จะแสดงหน้าต่างและโค้ด ดังรูปข้างล่าง
![](https://66.media.tumblr.com/cefe7de90b1c3c17fd0862d25b33ef50/tumblr_pqu6x9HBt91yo55ppo1_1280.png)
ในส่วนของ `#define DHTTYPE DHT22 ,DHTPIN D2` ไม่ต้องทำการเปลี่ยนหากผู้ใช้ต้องการตั้งค่าสายต่อช่องเดิม
## สิ่งที่ผู้ใช้งานจะต้องตั้งค่ามีดังนี้
1. `#define LINE_TOKEN_TMP1` และ `#define LINE_TOKEN_TMP2` ให้ทำการเปลี่ยนTOKEN Lineของผู้ใช้เอง โดยวิธีการรับTokenLine 
สามารถทำตามคลิปนี้ได้เลย[Watch tutorial click!!](https://www.youtube.com/watch?v=kiIDyb82eAg) หรือขั้นตอนด้านล่างดังนี้
      ### Login Linenotify
      ก่อนที่จะใช้งานเครื่อง Intelligent Weather Box ลูกค้าจำเป็นต้องเข้าไปที่หน้าเว็บไซต์ของ Line notify เพื่อทำการเข้าสู่ระบบของ Line
      1. ให้กด `Log in` ที่มุมขวาบน
      2. เข้าสู่ระบบของ `Line` ให้เรียบร้อย
      3. จากนั้นเลือก `My page`
![](https://66.media.tumblr.com/d63ab8717356564404fa729211e422cc/tumblr_pqu9qtEctc1yo55ppo2_1280.jpg)
      ### Token access Linenotify
      ต่อไปจะเป็นการขอ Token ที่ใช้สำหรับรับการแจ้งเตือนผ่าน Line notify
      1. กดเลือก `Generate token`
      2. ตั้งชื่อที่ผู้ส่งในกรอบสี่เหลี่ยมแรก
      3. เลือกผู้รับจากรายชื่อที่ให้เลือก (สามารถเลือก 1 ต่อ 1 หรือเลือกส่งเป็นกลุ่มได้)
      4. จากนั้นกดที่ Generate token `ปุ่มสีเขียว`
![](https://66.media.tumblr.com/1f13397f960132ce5b5cac51fa5c8f60/tumblr_pqu9qtEctc1yo55ppo1_1280.jpg)
      5. จากนั้นจะได้รับ `Token` ไปใส่ไว้ในโค้ดเพื่อระบุเป้าหมายที่เราจะส่งไป
![](https://66.media.tumblr.com/684369a12be609263f6987c3b11155c6/tumblr_pqu9qtEctc1yo55ppo3_1280.jpg)
2. นำToken ที่ได้จากข้างต้น มาใส่ ใน `#define LINE_TOKEN_TMP1` และ `#define LINE_TOKEN_TMP2` ด้านในเครื่องหมาย "" ตามที่วงไป
![](https://66.media.tumblr.com/e5c4fc5e40e2a20d138a2b53b53b5fff/tumblr_pqu86sns6V1yo55ppo3_1280.jpg)
3. เปลี่ยนการเชื่อมต่อระบบ internet Wifi ด้วยการเปลี่ยนชื่อไวไฟ หรือ `ssid` และ รหัสผ่านไวไฟ หรือ `password` ตามที่ผู้ใช้ต้องการให้ ESP82660
เชื่อมต่อกับไวไฟตัวไหนของผู้ใช้งาน
![](https://66.media.tumblr.com/93a6dbfcab6a4759c2c3415b8343baff/tumblr_pqu86sns6V1yo55ppo2_1280.jpg)
4. ในส่วนนี้ จะเป็นส่วนที่จะใช้ตั้งค่าเวลาว่าผู้ใช้งานอยากให้ข้อมูลแจ้งเตือนต่างๆผ่านระบบLinenotify ทุกๆกี่ชั่วโมง
### 
`1 วินาที = delay(1000)` `1 นาที = delay(60000)` `1 ชั่วโมง = delay(3600000)`
![](https://66.media.tumblr.com/1c192445257297fa50e05188c93e1877/tumblr_pqu86sns6V1yo55ppo1_1280.jpg)
5. ส่วนสุดท้ายผู้ใช้งาน สามารถเปลี่ยนข้อความในการส่งเข้าระบบLineได้ โดยแก้ไขข้อความตรงคำสั่ง`Linenotify()` แต่ทางกลุ่มผู้จัดทำไม่แนะนำให้แก้ไข
เนื่องจากได้มีการตั้งค่าให้ส่งข้อความนั้นๆ ตามเงื่อนไขต่างๆที่เซนเซอร์ตรวจจับไว้แล้ว หากผู้ใช้งานต้องการเปลี่ยนโปรดศึกษาและเปรียบเทียบก่อนทำการเปลี่ยน
เพื่อป้องกันการคลาดเคลื่อนหรือความหมายเปลี่ยนของการแจ้งเตือนเข้าสู่ระบบLine
![](https://66.media.tumblr.com/044b50c1bb86899cf5666122055f9415/tumblr_pqu86sns6V1yo55ppo4_1280.jpg)
6. หลังจากนั้นให้เราเชื่อต่อ Arduino ด้วยสาย USB แล้วกด `upload` ลง `NodeMCU`
***
# Notification การแจ้งเตือนผ่านระบบ Line สู่ผู้ใช้งาน
    เมื่อเราทำการ `upload` โค้ดและ `ESP82660` ได้ทำการเชื่อมต่อผ่านแล้ว เซนเซอร์จะทำการอ่านค่าอุณหภูมิ ความชื้นและปริมาณน้ำฝน จากนั้นมีการแจ้งเตือนส่งถึง `user` ที่เราได้เลือกเอาไว้ ในส่วนของข้อมูลที่แจ้งเตือนผ่าน LINEจะมีการเรียงลำดับข้อมูลดังนี้
![](https://66.media.tumblr.com/8b2e7325a1454aeccff01fe4ad953ddc/tumblr_pquccvxU0H1yo55ppo1_500.jpg)

| อันดับ | หัวข้อ                |ข้อมูลที่ได้                   |
| ------------- | ---------------------- | -------------------------- |
| 1 | `อุณหภูมิ` | เป็นการแจ้งข้อมูลอุณหภูมิ ณ สถานที่ๆเราได้ติดตั้งเครื่องเอาไว้ จะแจ้งเป็นองศาเซลเซียส (c) |
| 2 | `ความชื้น` | เป็นการแจ้งข้อมูลความชื้นในอากาศ โดยข้อมูลที่ได้จากคิดเป็นค่า % |
| 3 | `เตือนสภาพอากาศ` | เป็นการแจ้งเตือนในกรณีที่สภาพอากาศอยู่ในเกณฑ์ที่ร้านมาก หนาวมาก หรืออยู่ในขึ้นปกติ เพื่อให้ user ได้เตรียมตัวรับมือกับสภาพอากาศได้ในทันที |
| 4 | `เตือนฝนตก` | เป็นการแจ้งเตือนในกรณีที่พบปริมาณน้ำฝน นอกเหนือจากสภาพอากาศทั่วไป จะแจ้งเตือนให้ user ได้เตรียมตัวรับมือกับฝนที่เกิดขึ้น |
| 5 | `กราฟสรุป` | เป็นการสรุปข้อมูลอุณหภูมิจากเวลาที่ได้ตั้งไว้ เพื่อบอกถึงอัตรการเปลี่ยนแปลงของอุณหภูมิ และความชื้นทุกๆช่วงเวลานั้นที่มีการเปลี่ยนแปลง |
## Example notification ตัวอย่างข้อความแจ้งเตือนให้กับผู้ใช้งาน
* Normal สภาพอากาศปกติ
![](https://66.media.tumblr.com/a790f8a3b73bb95ba1a3535a63edc20c/tumblr_pqudcxgGLC1yo55ppo2_400.jpg)
* Raining เมื่อฝนกำลังตก
![](https://66.media.tumblr.com/138044d5ddfad9b09d29bfdbabb7ac61/tumblr_pque7mtpMo1yo55ppo2_400.jpg)
* Graph กราฟแสดงอุณหภูมิและความชื้นในอากาศ

![](https://66.media.tumblr.com/95f485eb294f23fe2948cf19d0ab9630/tumblr_pque7mtpMo1yo55ppo1_500.jpg)
![](https://66.media.tumblr.com/918cd74a76b080521ed603fab581ac53/tumblr_pquepyNZcx1yo55ppo1_1280.jpg)
***
# Members
|  | Name-Lastname                |GitHub Username                   |StudentID                   |
| ------------- | ---------------------- | -------------------------- |-------------------------- |
| ![](https://66.media.tumblr.com/e19283505e4574ed21ba7d187769e90d/tumblr_pqufduluQd1yo55ppo1_100.jpg) | Pattharanan Ruengchana | [@PattharananZ](https://github.com/PattharananZ) |61070156 |
| ![](https://66.media.tumblr.com/4d7fc9f691f8267bd3b1a4f157b1eaf5/tumblr_pqufduluQd1yo55ppo2_100.jpg) | Rattasit Sangwanpet | [@toeyratsit](https://github.com/toeyratsit) |61070184 |
| ![](https://66.media.tumblr.com/a3e2f34ac3eba78194d768b8f0713ac1/tumblr_pqufduluQd1yo55ppo4_100.jpg) | Wareerat Pinkaraket | [@pamnana](https://github.com/pamnana) |61070206 |
| ![](https://66.media.tumblr.com/dea0cbbf5cb6aca6b9b51a6a0176c31a/tumblr_pqufduluQd1yo55ppo3_100.jpg) | Sarunpon Chaichitatorn | [@pengsrp](https://github.com/pengsrp) |61070217 |
***
# Assistant Teacher
|  | Name                |Lastname                |
| ------------- | ---------------------- | -------------------------- |
| ![](https://66.media.tumblr.com/61ef10bca2131a7b9546a9711ddc60a8/tumblr_pqug7ucP161yo55ppo2_100.jpg) | Asst. Prof. Dr.kitsuchart | pasupa |
| ![](https://66.media.tumblr.com/9c76e350e84df8f7166b87b697256f61/tumblr_pqug7ucP161yo55ppo1_100.jpg) | Asst. Prof. Dr.Panwit  | Tuwanut |

Readme.md และ Source codeนี้ เป็นส่วนหนึ่งของวิชา การสร้างโปรแกรมคอมพิวเตอร์ Computer Programming
หลักสูตรวิทยาศาสตร์บัณฑิต สาขาวิชาเทคโนโลยีสารสนเทศ
ภาคเรียนที่ 2 ปีการศึกษา 2561
คณะเทคโนโลยีสารสนเทศ IT (Faculty of Information Technology, KMITL)
สถาบันเทคโนโลยีพระจอมเกล้าเจ้าคุณทหารลาดกระบัง
***
